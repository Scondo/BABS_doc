
# Публичный ключ/идентификатор

Для идентификации авторов, узлов, чатов и т.д. используется публичный ключ или его фрагмент. Фрагмента может быть достаточно как из факта случайного распределения, так и благодаря тому, что объектов в конкретном контексте может быть не очень много. Это может быть отправка сообщения в групповой чат, где нет авторов, чьи ключи начинались бы с этих байт; отправка личного сообщения с узла, где есть только один автор, начинающийся на эти байты; отправка через доску, если доске неизвестны другие авторы, начинающиеся на эти байты. Для публичных ключей Ed25519, которые представляют из себя случайные числа без дополнительных обёрток фрагмента 128 бит должно быть достаточно в любом практическом случае идентификации.

Тем не менее формат используется как для фрагментов, так и для полных публичных ключей. Если первый бит установлен в 0 - ключ представлен полностью. Если первый бит установлен в 1 - представлены только первые байты ключа. Если в тексте упоминается "идентификатор" - это может быть как фрагмент, так и полный ключ; если в тексте упоминается "публичный ключ" - публичный ключ должен быть представлен полностью.

Основной рекомендацией является использование Ed25519 для подписания и RSA для шифрования. 

TODO: Уточить возможность использовать ключи Ed25519 для шифрования

Данный формат предназначен для публичных ключей, но при использовании типа 11111 может также использоваться для описания приватных ключей (пока ждём RSA в мультикодеке).


## Формат хранения идентификатора
| Номер блока | Длина в байтах | Содержимое |
| --- | --- | --- |
| 1 | 1 | Заголовочный байт (см. ниже) |
| 2 | var(1-n) | Длина ключа, сохранённая как varint (N) |
| 3 | var(1-m) | Если тип ключа описывается 11111 - значение типа ключа по таблице multicodec |
| 4 | N - m | Значение ключа |

### Заголовочный байт
| Бит | Значение |
| --- | --- | 
| 1 | Полнота: 0 - полноценный ключ; 1 - фрагмент ключа (первые байты) | 
| 2-3 | Резерв (должно быть всегда 00) |
| 4-8 | Тип ключа <br/> - 00000 - RSA (сериализованный DER PKIX) <br/> - 00001 - Ed25519 <br/>- 00010 - зарезервировано для Secp256k1, не должно использоваться <br/>- 00011 - зарезервировано для ECDSA, не должно использоваться  <br/>- 11111 - тип описывается multicodec (допустимы только варианты с тэгом key), байт идентификации считается частью общей длины ключа  <br/>- Остальное - резерв |
